<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experience Details - Meet Taiwan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            line-height: 1.8;
            color: #2D6A4F;
            background: #F7F5F2;
        }
        
        /* æµ®å‹•å°è¦½åˆ— */
        .floating-nav {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            background: white;
            padding: 1rem;
            border-radius: 30px;
            box-shadow: 0 4px 20px rgba(45, 106, 79, 0.2);
            border: 2px solid #2D6A4F;
        }
        
        .floating-nav a {
            display: block;
            width: 50px;
            height: 50px;
            margin: 0.5rem 0;
            border-radius: 50%;
            background: linear-gradient(135deg, #2D6A4F, #40916C);
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: transform 0.3s;
        }
        
        .floating-nav a:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, #40916C, #52B788);
        }
        
        /* å›é ‚æŒ‰éˆ• */
        .back-to-top {
            position: fixed;
            right: 30px;
            bottom: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #F4845F, #F4A261);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(244, 132, 95, 0.4);
            display: none;
            z-index: 999;
            transition: transform 0.3s;
        }
        
        .back-to-top:hover {
            transform: translateY(-5px);
        }
        
        .back-to-top.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header {
            background: linear-gradient(135deg, #2D6A4F 0%, #40916C 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0;
        }
        
        .loading {
            text-align: center;
            padding: 4rem 2rem;
            font-size: 1.3rem;
            color: #2D6A4F;
            font-weight: bold;
        }
        
        /* ç…§ç‰‡å€ - å…¨å¯¬ */
        .photo-gallery {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0;
            background: #000;
            margin: 0;
        }
        
        .photo-item {
            width: 100%;
            height: 400px;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-placeholder {
            color: #999;
            font-size: 4rem;
        }
        
        /* ä¸»è¦å…§å®¹å€ */
        .content-wrapper {
            background: white;
            padding: 3rem 2rem;
            margin: 0 auto;
            max-width: 1200px;
        }
        
        .hero {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 3px solid #E9C46A;
        }
        
        .hero-emoji {
            font-size: 5rem;
            margin-bottom: 1rem;
        }
        
        .hero h1 {
            font-size: 3rem;
            color: #2D6A4F;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        
        .hero .subtitle {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 1.5rem;
        }
        
        .hero .description {
            font-size: 1.3rem;
            color: #333;
            line-height: 1.8;
            padding: 1.5rem;
            background: #F7F5F2;
            border-radius: 15px;
            margin-bottom: 1.5rem;
            border: 2px solid #E9C46A;
        }
        
        .meta-info {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .meta-tag {
            padding: 0.7rem 1.5rem;
            background: #F7F5F2;
            color: #2D6A4F;
            border: 2px solid #E9C46A;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
        }
        
        /* Google Docs å…§å®¹å€ */
        .doc-content {
            margin: 3rem 0;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid #2D6A4F;
            box-shadow: 0 4px 20px rgba(45, 106, 79, 0.15);
        }
        
        .doc-content h2 {
            background: linear-gradient(135deg, #2D6A4F, #40916C);
            color: white;
            padding: 1.5rem 2rem;
            margin: 0;
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .doc-content iframe {
            width: 100%;
            min-height: 800px;
            border: none;
            background: white;
        }
        
        .doc-link {
            padding: 1.5rem 2rem;
            background: #F7F5F2;
            text-align: center;
            border-top: 2px solid #E9C46A;
        }
        
        .doc-link a {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: linear-gradient(135deg, #F4845F, #F4A261);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 15px rgba(244, 132, 95, 0.3);
        }
        
        .doc-link a:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 132, 95, 0.4);
        }
        
        /* Google Maps */
        .map-section {
            margin: 3rem 0;
        }
        
        .map-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid #E9C46A;
            box-shadow: 0 4px 20px rgba(233, 196, 106, 0.2);
        }
        
        .map-container h2 {
            background: linear-gradient(135deg, #2D6A4F, #40916C);
            color: white;
            padding: 1.5rem 2rem;
            margin: 0;
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .map-container iframe {
            width: 100%;
            height: 500px;
            border: none;
        }
        
        .map-info {
            padding: 1.5rem 2rem;
            background: #F7F5F2;
            border-top: 2px solid #E9C46A;
        }
        
        .map-info a {
            color: #2D6A4F;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .map-info a:hover {
            text-decoration: underline;
            color: #F4845F;
        }
        
        .map-placeholder {
            padding: 3rem 2rem;
            text-align: center;
            background: #F7F5F2;
        }
        
        /* è¯çµ¡è³‡è¨Š */
        .contact-section {
            margin: 3rem 0;
        }
        
        .contact-box {
            background: white;
            border-radius: 15px;
            padding: 2.5rem;
            border: 3px solid #2D6A4F;
            box-shadow: 0 4px 20px rgba(45, 106, 79, 0.15);
        }
        
        .contact-box h2 {
            color: #2D6A4F;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #E9C46A;
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .contact-notice {
            background: #F7F5F2;
            border-left: 4px solid #E9C46A;
            padding: 1.2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            font-weight: bold;
            color: #2D6A4F;
        }
        
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .contact-item {
            padding: 1.5rem;
            background: #F7F5F2;
            border-radius: 15px;
            border: 2px solid #E9C46A;
            transition: transform 0.3s, border-color 0.3s;
        }
        
        .contact-item:hover {
            transform: translateY(-5px);
            border-color: #F4845F;
        }
        
        .contact-item .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .contact-item .label {
            font-weight: bold;
            color: #2D6A4F;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .contact-item a {
            color: #555;
            text-decoration: none;
            word-break: break-all;
        }
        
        .contact-item a:hover {
            color: #F4845F;
            text-decoration: underline;
        }
        
        /* éœ€è¦å”åŠ© */
        .help-section {
            margin: 3rem 0;
        }
        
        .help-box {
            background: linear-gradient(135deg, #2D6A4F, #40916C);
            color: white;
            padding: 3rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(45, 106, 79, 0.3);
        }
        
        .help-box h3 {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-weight: bold;
        }
        
        .help-box p {
            margin-bottom: 1.5rem;
            opacity: 0.95;
            font-size: 1.2rem;
        }
        
        .help-box .btn {
            display: inline-block;
            padding: 1.2rem 3rem;
            background: white;
            color: #2D6A4F;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            transition: transform 0.3s;
            font-size: 1.2rem;
        }
        
        .help-box .btn:hover {
            transform: translateY(-3px);
            background: #F4845F;
            color: white;
        }
        
        /* åº•éƒ¨å…è²¬è²æ˜ */
        .disclaimer-footer {
            padding: 2rem;
            font-size: 0.9rem;
            color: #666;
            text-align: center;
            line-height: 1.6;
            background: white;
            border-radius: 15px;
            margin: 2rem 0;
            border: 2px solid #E9C46A;
        }
        
        .disclaimer-footer strong {
            color: #2D6A4F;
        }
        
        .footer {
            background: linear-gradient(135deg, #2D6A4F, #40916C);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }
        
        .footer p {
            font-size: 1.1rem;
        }
        
        /* æ‰‹æ©Ÿç‰ˆé©é… */
        @media (max-width: 768px) {
            .floating-nav {
                left: 10px;
                padding: 0.5rem;
            }
            
            .floating-nav a {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .back-to-top {
                right: 15px;
                bottom: 15px;
                width: 50px;
                height: 50px;
            }
            
            .photo-gallery {
                grid-template-columns: 1fr;
            }
            
            .photo-item {
                height: 300px;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero .description {
                font-size: 1.1rem;
            }
            
            .content-wrapper {
                padding: 2rem 1rem;
            }
            
            .doc-content iframe {
                min-height: 600px;
            }
            
            .map-container iframe {
                height: 350px;
            }
            
            .contact-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- æµ®å‹•å°è¦½ -->
    <nav class="floating-nav">
        <a href="index.html" title="é¦–é ">ğŸ </a>
        <a href="experiences.html" title="é«”é©—">ğŸŒŸ</a>
        <a href="index.html#about" title="é—œæ–¼">â„¹ï¸</a>
        <a href="index.html#contact" title="è¯çµ¡">âœ‰ï¸</a>
    </nav>

    <!-- å›é ‚æŒ‰éˆ• -->
    <button class="back-to-top" onclick="scrollToTop()">â†‘</button>

    <header class="header">
        <h1>Meet Taiwan é‡è¦‹å°ç£</h1>
    </header>

    <div id="loading" class="loading">
        è¼‰å…¥é«”é©—è©³æƒ…ä¸­...<br>Loading experience details...
    </div>

    <div id="content" class="container" style="display: none;">
        <!-- ç…§ç‰‡å€ - å…¨å¯¬ -->
        <div class="photo-gallery" id="photoGallery">
            <div class="photo-item">
                <span class="photo-placeholder">ğŸ“·</span>
            </div>
            <div class="photo-item">
                <span class="photo-placeholder">ğŸ“·</span>
            </div>
            <div class="photo-item">
                <span class="photo-placeholder">ğŸ“·</span>
            </div>
        </div>

        <!-- ä¸»è¦å…§å®¹ -->
        <div class="content-wrapper">
            <div id="heroSection"></div>
            
            <!-- Google Docs å…§å®¹ -->
            <div class="doc-content" id="docContent">
                <h2>ğŸ“ è©³ç´°ä»‹ç´¹ Detailed Information</h2>
                <iframe id="docIframe" src="" loading="lazy"></iframe>
                <div class="doc-link">
                    <a href="" target="_blank" id="docLink">
                        ğŸ“„ åœ¨æ–°è¦–çª—é–‹å•Ÿå®Œæ•´æ–‡ä»¶ Open Full Document â†’
                    </a>
                </div>
            </div>
        </div>

        <!-- Google Maps -->
        <div class="content-wrapper">
            <div class="map-section" id="mapSection"></div>

            <!-- è¯çµ¡è³‡è¨Š -->
            <div class="contact-section" id="contactSection"></div>

            <!-- éœ€è¦å”åŠ© -->
            <div class="help-section">
                <div class="help-box">
                    <h3>ğŸ’¬ éœ€è¦èªè¨€æˆ–é ç´„å”åŠ©å—?</h3>
                    <p>Need Help with Language or Booking?</p>
                    <p style="font-size: 1rem;">
                        å¦‚æœèªè¨€æˆ–æ–‡åŒ–éš”é–¡é€ æˆå›°é›£,æˆ‘å€‘å¾ˆæ¨‚æ„å”åŠ©æ‚¨å»ºç«‹é€£çµ<br>
                        We're happy to help you connect if language barriers are challenging
                    </p>
                    <a href="mailto:contact@example.com" class="btn">
                        è¯çµ¡æˆ‘å€‘ Contact Us
                    </a>
                </div>
            </div>

            <!-- åº•éƒ¨å°å…è²¬è²æ˜ -->
            <div class="disclaimer-footer">
                <strong>â„¹ï¸ å…è²¬è²æ˜ Disclaimer:</strong><br>
                æœ¬é é¢ç”± Meet Taiwan ç¨ç«‹æ•´ç†,æˆ‘å€‘èˆ‡æ­¤çµ„ç¹”ç„¡éš¸å±¬æˆ–ä»£ç†é—œä¿‚ã€‚æ‰€æœ‰è¯çµ¡è³‡è¨Šå‡ç‚ºå…¬é–‹è³‡æ–™ã€‚<br>
                This page is independently curated by Meet Taiwan. We are not affiliated with this organization. All contact information is publicly available.
            </div>
        </div>
    </div>

    <footer class="footer">
        <p><strong>Meet Taiwan é‡è¦‹å°ç£</strong></p>
        <p style="margin-top: 1rem; opacity: 0.9;">
            Independent Information Platform
        </p>
    </footer>

    <script>
        const SHEET_ID = '1GD4gg3sGIfX7KGrJkYCL10wzvwZh5FMWQPGd9NVTQyc';
        const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

        const categoryEmojis = {
            'é£²é£Ÿæ–‡åŒ–': 'ğŸœ',
            'ç¤¾å€ç”Ÿæ´»': 'ğŸ˜ï¸',
            'å»ºç¯‰è—è¡“': 'ğŸ›ï¸',
            'å‚³çµ±å·¥è—': 'ğŸ¨',
            'ç’°å¢ƒç”Ÿæ…‹': 'ğŸŒ±',
            'è¾²æ‘ç”Ÿæ´»': 'ğŸŒ¾',
            'å…¶ä»–': 'ğŸ“'
        };

        const regionEmojis = {
            'åŒ—å°ç£': 'ğŸ™ï¸',
            'ä¸­å°ç£': 'ğŸ”ï¸',
            'å—è‡ºç£': 'ğŸŒ´',
            'èŠ±æ±': 'ğŸŒŠ',
            'é›¢å³¶': 'ğŸï¸'
        };

        function getExperienceId() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        async function loadExperience() {
            const id = getExperienceId();
            
            if (!id) {
                showError('æ‰¾ä¸åˆ°é«”é©— ID<br>Experience ID not found');
                return;
            }

            try {
                const response = await fetch(SHEET_URL);
                const csvText = await response.text();
                const rows = parseCSV(csvText);
                const headers = rows[0];
                const data = rows.slice(1);
                
                const experience = data.map(row => {
                    const obj = {};
                    headers.forEach((header, index) => {
                        obj[header] = row[index] || '';
                    });
                    return obj;
                }).find(exp => exp['ID'] === id);

                if (experience) {
                    displayExperience(experience);
                } else {
                    showError('æ‰¾ä¸åˆ°æ­¤é«”é©—<br>Experience not found');
                }
                
            } catch (error) {
                console.error('è¼‰å…¥å¤±æ•—:', error);
                showError('è¼‰å…¥å¤±æ•—<br>Loading failed');
            }
        }

        function displayExperience(exp) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
            
            const emoji = categoryEmojis[exp['ä¸»è¦åˆ†é¡']] || regionEmojis[exp['åœ°å€']] || 'ğŸ“';
            
            document.title = `${exp['é«”é©—åç¨±(ä¸­)']} - Meet Taiwan`;
            
            displayPhotos(exp);
            
            document.getElementById('heroSection').innerHTML = `
                <div class="hero">
                    <div class="hero-emoji">${emoji}</div>
                    <h1>${exp['é«”é©—åç¨±(ä¸­)']}</h1>
                    ${exp['é«”é©—åç¨±(è‹±)'] ? `<div class="subtitle">${exp['é«”é©—åç¨±(è‹±)']}</div>` : ''}
                    ${exp['ä¸€å¥è©±æè¿°(ä¸­)'] ? `<div class="description">${exp['ä¸€å¥è©±æè¿°(ä¸­)']}</div>` : ''}
                    <div class="meta-info">
                        ${exp['åœ°å€'] ? `<span class="meta-tag">ğŸ“ ${exp['åœ°å€']}</span>` : ''}
                        ${exp['ä¸»è¦åˆ†é¡'] ? `<span class="meta-tag">${exp['ä¸»è¦åˆ†é¡']}</span>` : ''}
                        ${exp['é›£åº¦'] ? `<span class="meta-tag">â­ é›£åº¦: ${exp['é›£åº¦']}</span>` : ''}
                    </div>
                </div>
            `;
            
            loadGoogleDoc(exp);
            displayMap(exp);
            displayContact(exp);
        }

        function displayPhotos(exp) {
            const gallery = document.getElementById('photoGallery');
            const imageUrls = exp['å°é¢åœ–é€£çµ'] ? exp['å°é¢åœ–é€£çµ'].split(',').map(url => url.trim()) : [];
            
            if (imageUrls.length > 0 && imageUrls[0]) {
                gallery.innerHTML = '';
                for (let i = 0; i < 3; i++) {
                    const imageUrl = imageUrls[i];
                    if (imageUrl) {
                        gallery.innerHTML += `
                            <div class="photo-item">
                                <img src="${imageUrl}" alt="é«”é©—ç…§ç‰‡ ${i+1}" onerror="this.parentElement.innerHTML='<span class=\'photo-placeholder\'>ğŸ“·</span>'">
                            </div>
                        `;
                    } else {
                        gallery.innerHTML += `
                            <div class="photo-item">
                                <span class="photo-placeholder">ğŸ“·</span>
                            </div>
                        `;
                    }
                }
            }
        }

        function loadGoogleDoc(exp) {
            if (exp['è©³ç´°å…§å®¹Doc']) {
                let embedUrl = exp['è©³ç´°å…§å®¹Doc'];
                let fullUrl = exp['è©³ç´°å…§å®¹Doc'];
                
                if (embedUrl.includes('/pub')) {
                    embedUrl = embedUrl.replace('/pub', '/pub?embedded=true');
                } else if (embedUrl.includes('/edit')) {
                    const docId = embedUrl.match(/\/d\/([a-zA-Z0-9-_]+)/);
                    if (docId) {
                        embedUrl = `https://docs.google.com/document/d/e/2PACX-1vQj1gYlRDbgpH-IupwfkeS8kSMIvGb9TadFFwGpzj9TJXLYv3kzvhu9BqcpUetG-y7Dpt2M8qJLFkoV/pub?embedded=true`;
                        fullUrl = `https://docs.google.com/document/d/e/2PACX-1vQj1gYlRDbgpH-IupwfkeS8kSMIvGb9TadFFwGpzj9TJXLYv3kzvhu9BqcpUetG-y7Dpt2M8qJLFkoV/pub`;
                    }
                }
                
                document.getElementById('docIframe').src = embedUrl;
                document.getElementById('docLink').href = fullUrl;
            } else {
                document.getElementById('docContent').style.display = 'none';
            }
        }

        function displayMap(exp) {
            const mapSection = document.getElementById('mapSection');
            
            if (exp['åœ°å€']) {
                const embedUrl = `https://www.google.com/maps?q=${encodeURIComponent(exp['åœ°å€'])}&output=embed`;
                
                mapSection.innerHTML = `
                    <div class="map-container">
                        <h2>ğŸ—ºï¸ ä½ç½® Location</h2>
                        <iframe
                            src="${embedUrl}"
                            allowfullscreen=""
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                        <div class="map-info">
                            ${exp['Google Maps'] ? `
                                <p style="margin-bottom: 0.5rem;">
                                    <a href="${exp['Google Maps']}" target="_blank">
                                        ğŸ“ åœ¨ Google Maps ä¸­é–‹å•Ÿ Open in Google Maps â†’
                                    </a>
                                </p>
                            ` : ''}
                            <p style="margin: 0; color: #555; font-weight: 500;">ğŸ“® ${exp['åœ°å€']}</p>
                        </div>
                    </div>
                `;
            } else if (exp['Google Maps']) {
                mapSection.innerHTML = `
                    <div class="map-container">
                        <h2>ğŸ—ºï¸ ä½ç½® Location</h2>
                        <div class="map-placeholder">
                            <a href="${exp['Google Maps']}" target="_blank" 
                               style="display: inline-block; padding: 1rem 2rem; background: linear-gradient(135deg, #F4845F, #F4A261); color: white; text-decoration: none; border-radius: 50px; font-size: 1.1rem; font-weight: bold;">
                                ğŸ“ åœ¨ Google Maps ä¸­æŸ¥çœ‹ View on Google Maps â†’
                            </a>
                        </div>
                    </div>
                `;
            }
        }

        function displayContact(exp) {
            const contactSection = document.getElementById('contactSection');
            
            let hasContact = exp['å®˜æ–¹ç¶²ç«™'] || exp['Facebook'] || exp['é›»è©±'] || exp['Email'];
            
            if (!hasContact) {
                contactSection.innerHTML = '';
                return;
            }
            
            contactSection.innerHTML = `
                <div class="contact-box">
                    <h2>ğŸ“ è¯çµ¡è³‡è¨Š Contact Information</h2>
                    
                    <div class="contact-notice">
                        âš ï¸ <strong>è«‹ç›´æ¥è¯ç¹«ä¸»è¾¦å–®ä½å®‰æ’åƒè¨ª</strong><br>
                        Please contact the organization directly to arrange your visit
                    </div>
                    
                    <div class="contact-grid">
                        ${exp['å®˜æ–¹ç¶²ç«™'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸŒ</div>
                                <div class="label">Website å®˜ç¶²</div>
                                <a href="${exp['å®˜æ–¹ç¶²ç«™']}" target="_blank">${exp['å®˜æ–¹ç¶²ç«™']}</a>
                            </div>
                        ` : ''}
                        
                        ${exp['Facebook'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸ“˜</div>
                                <div class="label">Facebook</div>
                                <a href="${exp['Facebook']}" target="_blank">Facebook Page</a>
                            </div>
                        ` : ''}
                        
                        ${exp['é›»è©±'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸ“</div>
                                <div class="label">Phone é›»è©±</div>
                                <div style="font-weight: bold; color: #2D6A4F;">${exp['é›»è©±']}</div>
                            </div>
                        ` : ''}
                        
                        ${exp['Email'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸ“§</div>
                                <div class="label">Email</div>
                                <a href="mailto:${exp['Email']}">${exp['Email']}</a>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function parseCSV(csv) {
            const lines = csv.split('\n');
            return lines.map(line => {
                const values = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        values.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(current.trim());
                return values;
            });
        }

        function showError(message) {
            document.getElementById('loading').innerHTML = `
                <p style="color: #2D6A4F; font-size: 1.5rem; font-weight: bold;">${message}</p>
                <p style="margin-top: 1rem;">
                    <a href="experiences.html" style="color: #2D6A4F; text-decoration: none; font-weight: bold;">â† è¿”å›æ‰€æœ‰é«”é©— Back to All Experiences</a>
                </p>
            `;
        }

        // å›é ‚æŒ‰éˆ•
        window.addEventListener('scroll', function() {
            const backToTop = document.querySelector('.back-to-top');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        window.addEventListener('DOMContentLoaded', loadExperience);
    </script>
</body>
</html>
