<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experience Details - Meet Taiwan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            line-height: 1.8;
            color: #333;
            background: #f8f9fa;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 2rem;
            text-align: center;
        }
        
        .header h1 {
            font-size: 1.5rem;
        }
        
        .nav {
            background: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }
        
        .nav a:hover {
            text-decoration: underline;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
        }
        
        .loading {
            text-align: center;
            padding: 4rem 2rem;
            font-size: 1.2rem;
            color: #666;
        }
        
        /* ç…§ç‰‡å€ */
        .photo-gallery {
            width: 100%;
            height: 400px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
            background: #000;
            margin-bottom: 0;
        }
        
        .photo-item {
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-placeholder {
            color: #999;
            font-size: 3rem;
        }
        
        .photo-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.6));
            color: white;
            padding: 1rem;
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .photo-item:hover .photo-overlay {
            opacity: 1;
        }
        
        /* ä¸»è¦å…§å®¹å€ */
        .content-wrapper {
            background: white;
            padding: 3rem 2rem 2rem 2rem;
        }
        
        .hero {
            max-width: 900px;
            margin: 0 auto 3rem auto;
            text-align: center;
        }
        
        .hero-emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .hero .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 1.5rem;
        }
        
        .hero .description {
            font-size: 1.2rem;
            color: #555;
            line-height: 1.8;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        
        .meta-info {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .meta-tag {
            padding: 0.6rem 1.2rem;
            background: #e7f3ff;
            color: #0066cc;
            border-radius: 25px;
            font-size: 0.95rem;
            font-weight: 500;
        }
        
        .content-section {
            max-width: 900px;
            margin: 0 auto 3rem auto;
            padding: 2rem;
            background: #fff;
            border-radius: 8px;
        }
        
        .content-section h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e7f3ff;
            font-size: 1.8rem;
        }
        
        .content-section h3 {
            color: #555;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        
        .content-section p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }
        
        .content-section ul, .content-section ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }
        
        .content-section li {
            margin-bottom: 0.5rem;
        }
        
        /* Google Maps */
        .map-section {
            max-width: 900px;
            margin: 0 auto 3rem auto;
            padding: 0 2rem;
        }
        
        .map-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .map-container h2 {
            padding: 1.5rem 2rem;
            margin: 0;
            color: #667eea;
            border-bottom: 2px solid #e7f3ff;
        }
        
        .map-container iframe {
            width: 100%;
            height: 450px;
            border: none;
        }
        
        .map-placeholder {
            padding: 3rem 2rem;
            text-align: center;
            color: #999;
        }
        
        /* è¯çµ¡è³‡è¨Š */
        .contact-section {
            max-width: 900px;
            margin: 0 auto 3rem auto;
            padding: 0 2rem;
        }
        
        .contact-box {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .contact-box h2 {
            color: #667eea;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e7f3ff;
        }
        
        .contact-notice {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 4px;
            color: #856404;
        }
        
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .contact-item {
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .contact-item .icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .contact-item .label {
            font-weight: 600;
            color: #555;
            margin-bottom: 0.3rem;
        }
        
        .contact-item a {
            color: #0066cc;
            text-decoration: none;
            word-break: break-all;
        }
        
        .contact-item a:hover {
            text-decoration: underline;
        }
        
        /* éœ€è¦å”åŠ© */
        .help-section {
            max-width: 900px;
            margin: 0 auto 3rem auto;
            padding: 0 2rem;
        }
        
        .help-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2.5rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .help-box h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .help-box p {
            margin-bottom: 1.5rem;
            opacity: 0.95;
            font-size: 1.05rem;
        }
        
        .help-box .btn {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 30px;
            font-weight: bold;
            transition: transform 0.3s;
            font-size: 1.05rem;
        }
        
        .help-box .btn:hover {
            transform: translateY(-2px);
        }
        
        /* åº•éƒ¨å…è²¬è²æ˜ */
        .disclaimer-footer {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            font-size: 0.85rem;
            color: #999;
            text-align: center;
            line-height: 1.6;
        }
        
        .disclaimer-footer strong {
            color: #666;
        }
        
        .footer {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .photo-gallery {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .photo-item {
                height: 250px;
            }
            
            .hero h1 {
                font-size: 1.8rem;
            }
            
            .content-wrapper {
                padding: 2rem 1rem;
            }
            
            .content-section,
            .map-section,
            .contact-section,
            .help-section {
                padding: 0 1rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>Meet Taiwan é‡è¦‹å°ç£</h1>
    </header>

    <nav class="nav">
        <a href="experiences.html">â† è¿”å›æ‰€æœ‰é«”é©— Back to All Experiences</a>
    </nav>

    <div id="loading" class="loading">
        è¼‰å…¥é«”é©—è©³æƒ…ä¸­...<br>Loading experience details...
    </div>

    <div id="content" class="container" style="display: none;">
        <!-- ç…§ç‰‡å€ -->
        <div class="photo-gallery" id="photoGallery">
            <div class="photo-item">
                <span class="photo-placeholder">ğŸ“·</span>
            </div>
            <div class="photo-item">
                <span class="photo-placeholder">ğŸ“·</span>
            </div>
            <div class="photo-item">
                <span class="photo-placeholder">ğŸ“·</span>
            </div>
        </div>

        <!-- ä¸»è¦å…§å®¹ -->
        <div class="content-wrapper">
            <div id="heroSection"></div>
            <div id="detailContent"></div>
        </div>

        <!-- Google Maps -->
        <div class="map-section" id="mapSection"></div>

        <!-- è¯çµ¡è³‡è¨Š -->
        <div class="contact-section" id="contactSection"></div>

        <!-- éœ€è¦å”åŠ© -->
        <div class="help-section">
            <div class="help-box">
                <h3>ğŸ’¬ éœ€è¦èªè¨€æˆ–é ç´„å”åŠ©å—?</h3>
                <p>Need Help with Language or Booking?</p>
                <p style="font-size: 0.95rem;">
                    å¦‚æœèªè¨€æˆ–æ–‡åŒ–éš”é–¡é€ æˆå›°é›£,æˆ‘å€‘å¾ˆæ¨‚æ„å”åŠ©æ‚¨å»ºç«‹é€£çµ<br>
                    We're happy to help you connect if language barriers are challenging
                </p>
                <a href="mailto:contact@example.com" class="btn">
                    è¯çµ¡æˆ‘å€‘ Contact Us
                </a>
            </div>
        </div>

        <!-- åº•éƒ¨å°å…è²¬è²æ˜ -->
        <div class="disclaimer-footer">
            <strong>â„¹ï¸ å…è²¬è²æ˜ Disclaimer:</strong><br>
            æœ¬é é¢ç”± Meet Taiwan ç¨ç«‹æ•´ç†,æˆ‘å€‘èˆ‡æ­¤çµ„ç¹”ç„¡éš¸å±¬æˆ–ä»£ç†é—œä¿‚ã€‚æ‰€æœ‰è¯çµ¡è³‡è¨Šå‡ç‚ºå…¬é–‹è³‡æ–™ã€‚<br>
            This page is independently curated by Meet Taiwan. We are not affiliated with this organization. All contact information is publicly available.
        </div>
    </div>

    <footer class="footer">
        <p>Meet Taiwan é‡è¦‹å°ç£</p>
        <p style="margin-top: 1rem; opacity: 0.7;">
            Independent Information Platform
        </p>
    </footer>

    <script>
        const SHEET_ID = '1GD4gg3sGIfX7KGrJkYCL10wzvwZh5FMWQPGd9NVTQyc';
        const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

        const categoryEmojis = {
            'é£²é£Ÿæ–‡åŒ–': 'ğŸœ',
            'ç¤¾å€ç”Ÿæ´»': 'ğŸ˜ï¸',
            'å»ºç¯‰è—è¡“': 'ğŸ›ï¸',
            'å‚³çµ±å·¥è—': 'ğŸ¨',
            'ç’°å¢ƒç”Ÿæ…‹': 'ğŸŒ±',
            'è¾²æ‘ç”Ÿæ´»': 'ğŸŒ¾',
            'å…¶ä»–': 'ğŸ“'
        };

        const regionEmojis = {
            'åŒ—å°ç£': 'ğŸ™ï¸',
            'ä¸­å°ç£': 'ğŸ”ï¸',
            'å—è‡ºç£': 'ğŸŒ´',
            'èŠ±æ±': 'ğŸŒŠ',
            'é›¢å³¶': 'ğŸï¸'
        };

        function getExperienceId() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        async function loadExperience() {
            const id = getExperienceId();
            
            if (!id) {
                showError('æ‰¾ä¸åˆ°é«”é©— ID<br>Experience ID not found');
                return;
            }

            try {
                const response = await fetch(SHEET_URL);
                const csvText = await response.text();
                const rows = parseCSV(csvText);
                const headers = rows[0];
                const data = rows.slice(1);
                
                const experience = data.map(row => {
                    const obj = {};
                    headers.forEach((header, index) => {
                        obj[header] = row[index] || '';
                    });
                    return obj;
                }).find(exp => exp['ID'] === id);

                if (experience) {
                    displayExperience(experience);
                } else {
                    showError('æ‰¾ä¸åˆ°æ­¤é«”é©—<br>Experience not found');
                }
                
            } catch (error) {
                console.error('è¼‰å…¥å¤±æ•—:', error);
                showError('è¼‰å…¥å¤±æ•—<br>Loading failed');
            }
        }

        function displayExperience(exp) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
            
            const emoji = categoryEmojis[exp['ä¸»è¦åˆ†é¡']] || regionEmojis[exp['åœ°å€']] || 'ğŸ“';
            
            // æ›´æ–°é é¢æ¨™é¡Œ
            document.title = `${exp['é«”é©—åç¨±(ä¸­)']} - Meet Taiwan`;
            
            // ç…§ç‰‡å€ (æš«æ™‚é¡¯ç¤º placeholder,ä¹‹å¾Œå¯ä»¥å¾ Sheets è®€å–åœ–ç‰‡é€£çµ)
            displayPhotos(exp);
            
            // Hero å€å¡Š
            document.getElementById('heroSection').innerHTML = `
                <div class="hero">
                    <div class="hero-emoji">${emoji}</div>
                    <h1>${exp['é«”é©—åç¨±(ä¸­)']}</h1>
                    ${exp['é«”é©—åç¨±(è‹±)'] ? `<div class="subtitle">${exp['é«”é©—åç¨±(è‹±)']}</div>` : ''}
                    ${exp['ä¸€å¥è©±æè¿°(ä¸­)'] ? `<div class="description">${exp['ä¸€å¥è©±æè¿°(ä¸­)']}</div>` : ''}
                    <div class="meta-info">
                        ${exp['åœ°å€'] ? `<span class="meta-tag">ğŸ“ ${exp['åœ°å€']}</span>` : ''}
                        ${exp['ä¸»è¦åˆ†é¡'] ? `<span class="meta-tag">${exp['ä¸»è¦åˆ†é¡']}</span>` : ''}
                        ${exp['é›£åº¦'] ? `<span class="meta-tag">â­ é›£åº¦: ${exp['é›£åº¦']}</span>` : ''}
                    </div>
                </div>
            `;
            
            // è©³ç´°å…§å®¹
            displayDetailContent(exp);
            
            // Google Maps
            displayMap(exp);
            
            // è¯çµ¡è³‡è¨Š
            displayContact(exp);
        }

        function displayPhotos(exp) {
            const gallery = document.getElementById('photoGallery');
            
            // å¦‚æœæœ‰å°é¢åœ–é€£çµ,é¡¯ç¤ºåœ–ç‰‡
            // ç›®å‰å…ˆé¡¯ç¤º placeholder,ä¹‹å¾Œå¯ä»¥æ“´å……
            const imageUrls = exp['å°é¢åœ–é€£çµ'] ? exp['å°é¢åœ–é€£çµ'].split(',').map(url => url.trim()) : [];
            
            if (imageUrls.length > 0 && imageUrls[0]) {
                gallery.innerHTML = '';
                for (let i = 0; i < 3; i++) {
                    const imageUrl = imageUrls[i];
                    if (imageUrl) {
                        gallery.innerHTML += `
                            <div class="photo-item">
                                <img src="${imageUrl}" alt="é«”é©—ç…§ç‰‡ ${i+1}" onerror="this.parentElement.innerHTML='<span class=\'photo-placeholder\'>ğŸ“·</span>'">
                            </div>
                        `;
                    } else {
                        gallery.innerHTML += `
                            <div class="photo-item">
                                <span class="photo-placeholder">ğŸ“·</span>
                            </div>
                        `;
                    }
                }
            }
        }

        function displayDetailContent(exp) {
            const content = document.getElementById('detailContent');
            
            let html = '';
            
            // è©³ç´°ä»‹ç´¹
            if (exp['è©³ç´°ä»‹ç´¹']) {
                html += `
                    <div class="content-section">
                        <h2>ğŸ“ è©³ç´°ä»‹ç´¹ About This Experience</h2>
                        ${formatText(exp['è©³ç´°ä»‹ç´¹'])}
                    </div>
                `;
            }
            
            // èªè­˜åœ¨åœ°äºº
            if (exp['èªè­˜åœ¨åœ°äºº']) {
                html += `
                    <div class="content-section">
                        <h2>ğŸ‘‹ èªè­˜åœ¨åœ°äºº Meet Your Local</h2>
                        ${formatText(exp['èªè­˜åœ¨åœ°äºº'])}
                    </div>
                `;
            }
            
            // æœŸå¾…ä»€éº¼
            if (exp['æœŸå¾…ä»€éº¼']) {
                html += `
                    <div class="content-section">
                        <h2>ğŸ¯ æœŸå¾…ä»€éº¼ What to Expect</h2>
                        ${formatText(exp['æœŸå¾…ä»€éº¼'])}
                    </div>
                `;
            }
            
            // ç‚ºä»€éº¼é‡è¦
            if (exp['ç‚ºä»€éº¼é‡è¦']) {
                html += `
                    <div class="content-section">
                        <h2>ğŸ’¡ ç‚ºä»€éº¼é‡è¦ Why This Matters</h2>
                        ${formatText(exp['ç‚ºä»€éº¼é‡è¦'])}
                    </div>
                `;
            }
            
            // å¯¦ç”¨è³‡è¨Š
            if (exp['å¯¦ç”¨è³‡è¨Š']) {
                html += `
                    <div class="content-section">
                        <h2>ğŸ“‹ å¯¦ç”¨è³‡è¨Š Practical Information</h2>
                        ${formatText(exp['å¯¦ç”¨è³‡è¨Š'])}
                    </div>
                `;
            }
            
            // å¦‚æœæœ‰ Google Doc é€£çµ
            if (exp['è©³ç´°å…§å®¹Doc']) {
                html += `
                    <div class="content-section">
                        <p style="text-align: center;">
                            <a href="${exp['è©³ç´°å…§å®¹Doc']}" target="_blank" style="display: inline-block; padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 5px;">
                                ğŸ“„ æŸ¥çœ‹å®Œæ•´ Google Doc View Full Document â†’
                            </a>
                        </p>
                    </div>
                `;
            }
            
            content.innerHTML = html || `
                <div class="content-section">
                    <p style="text-align: center; color: #999;">è©³ç´°å…§å®¹æº–å‚™ä¸­...<br>Detailed content coming soon...</p>
                </div>
            `;
        }

function displayMap(exp) {
    const mapSection = document.getElementById('mapSection');
    
    if (exp['Google Maps']) {
        let mapsUrl = exp['Google Maps'];
        
        // å¦‚æœæ˜¯çŸ­ç¶²å€,é¡¯ç¤ºé€£çµä½†å…ˆä¸åµŒå…¥
        if (mapsUrl.includes('maps.app.goo.gl') || mapsUrl.includes('goo.gl')) {
            mapSection.innerHTML = `
                <div class="map-container">
                    <h2>ğŸ—ºï¸ ä½ç½® Location</h2>
                    <div class="map-placeholder">
                        <p style="margin-bottom: 1rem;">
                            <a href="${mapsUrl}" target="_blank" 
                               style="display: inline-block; padding: 1rem 2rem; background: #667eea; color: white; text-decoration: none; border-radius: 8px; font-size: 1.1rem;">
                                ğŸ“ åœ¨ Google Maps ä¸­æŸ¥çœ‹ View on Google Maps â†’
                            </a>
                        </p>
                        ${exp['åœ°å€'] ? `<p style="color: #666; font-size: 1.05rem;">ğŸ“® ${exp['åœ°å€']}</p>` : ''}
                    </div>
                </div>
            `;
            return;
        }
        
        // è™•ç†å®Œæ•´çš„ Google Maps ç¶²å€
        let embedUrl = '';
        
        if (mapsUrl.includes('google.com/maps')) {
            // å˜—è©¦å¾ç¶²å€ä¸­æå–åº§æ¨™
            const coordMatch = mapsUrl.match(/@(-?\d+\.\d+),(-?\d+\.\d+)/);
            if (coordMatch) {
                const lat = coordMatch[1];
                const lng = coordMatch[2];
                embedUrl = `https://www.google.com/maps?q=${lat},${lng}&output=embed`;
            } else if (exp['åœ°å€']) {
                // ç”¨åœ°å€æœå°‹
                embedUrl = `https://www.google.com/maps?q=${encodeURIComponent(exp['åœ°å€'])}&output=embed`;
            }
        }
        
        if (embedUrl) {
            mapSection.innerHTML = `
                <div class="map-container">
                    <h2>ğŸ—ºï¸ ä½ç½® Location</h2>
                    <iframe
                        src="${embedUrl}"
                        allowfullscreen=""
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                    <div style="padding: 1rem 2rem; background: #f8f9fa;">
                        <p style="margin: 0;">
                            <a href="${mapsUrl}" target="_blank" style="color: #0066cc; text-decoration: none;">
                                ğŸ“ åœ¨ Google Maps ä¸­é–‹å•Ÿ Open in Google Maps â†’
                            </a>
                        </p>
                        ${exp['åœ°å€'] ? `<p style="margin: 0.5rem 0 0 0; color: #666;">ğŸ“® ${exp['åœ°å€']}</p>` : ''}
                    </div>
                </div>
            `;
        } else {
            // ç„¡æ³•åµŒå…¥,åªé¡¯ç¤ºé€£çµ
            mapSection.innerHTML = `
                <div class="map-container">
                    <h2>ğŸ—ºï¸ ä½ç½® Location</h2>
                    <div class="map-placeholder">
                        <p>
                            <a href="${mapsUrl}" target="_blank" 
                               style="display: inline-block; padding: 1rem 2rem; background: #667eea; color: white; text-decoration: none; border-radius: 8px; font-size: 1.1rem;">
                                ğŸ“ åœ¨ Google Maps ä¸­æŸ¥çœ‹ View on Google Maps â†’
                            </a>
                        </p>
                        ${exp['åœ°å€'] ? `<p style="margin-top: 1rem; color: #666; font-size: 1.05rem;">ğŸ“® ${exp['åœ°å€']}</p>` : ''}
                    </div>
                </div>
            `;
        }
    } else if (exp['åœ°å€']) {
        // åªæœ‰åœ°å€æ²’æœ‰ Maps é€£çµ
        const embedUrl = `https://www.google.com/maps?q=${encodeURIComponent(exp['åœ°å€'])}&output=embed`;
        
        mapSection.innerHTML = `
            <div class="map-container">
                <h2>ğŸ—ºï¸ ä½ç½® Location</h2>
                <iframe
                    src="${embedUrl}"
                    allowfullscreen=""
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade">
                </iframe>
                <div style="padding: 1rem 2rem; background: #f8f9fa;">
                    <p style="margin: 0; color: #666;">ğŸ“® ${exp['åœ°å€']}</p>
                </div>
            </div>
        `;
    }
}

        function displayContact(exp) {
            const contactSection = document.getElementById('contactSection');
            
            let hasContact = exp['å®˜æ–¹ç¶²ç«™'] || exp['Facebook'] || exp['é›»è©±'] || exp['Email'];
            
            if (!hasContact) {
                contactSection.innerHTML = '';
                return;
            }
            
            contactSection.innerHTML = `
                <div class="contact-box">
                    <h2>ğŸ“ è¯çµ¡è³‡è¨Š Contact Information</h2>
                    
                    <div class="contact-notice">
                        âš ï¸ <strong>è«‹ç›´æ¥è¯ç¹«ä¸»è¾¦å–®ä½å®‰æ’åƒè¨ª</strong><br>
                        Please contact the organization directly to arrange your visit
                    </div>
                    
                    <div class="contact-grid">
                        ${exp['å®˜æ–¹ç¶²ç«™'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸŒ</div>
                                <div class="label">Website å®˜ç¶²</div>
                                <a href="${exp['å®˜æ–¹ç¶²ç«™']}" target="_blank">${exp['å®˜æ–¹ç¶²ç«™']}</a>
                            </div>
                        ` : ''}
                        
                        ${exp['Facebook'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸ“˜</div>
                                <div class="label">Facebook</div>
                                <a href="${exp['Facebook']}" target="_blank">Facebook Page</a>
                            </div>
                        ` : ''}
                        
                        ${exp['é›»è©±'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸ“</div>
                                <div class="label">Phone é›»è©±</div>
                                <div>${exp['é›»è©±']}</div>
                            </div>
                        ` : ''}
                        
                        ${exp['Email'] ? `
                            <div class="contact-item">
                                <div class="icon">ğŸ“§</div>
                                <div class="label">Email</div>
                                <a href="mailto:${exp['Email']}">${exp['Email']}</a>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function formatText(text) {
            if (!text) return '';
            
            // å°‡æ›è¡Œè½‰æ›æˆ <p> æ¨™ç±¤
            return text.split('\n\n')
                .filter(para => para.trim())
                .map(para => `<p>${para.trim().replace(/\n/g, '<br>')}</p>`)
                .join('');
        }

        function parseCSV(csv) {
            const lines = csv.split('\n');
            return lines.map(line => {
                const values = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        values.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(current.trim());
                return values;
            });
        }

        function showError(message) {
            document.getElementById('loading').innerHTML = `
                <p style="color: #dc3545; font-size: 1.2rem;">${message}</p>
                <p style="margin-top: 1rem;">
                    <a href="experiences.html" style="color: #667eea; text-decoration: none;">â† è¿”å›æ‰€æœ‰é«”é©— Back to All Experiences</a>
                </p>
            `;
        }

        window.addEventListener('DOMContentLoaded', loadExperience);
    </script>
</body>
</html>
